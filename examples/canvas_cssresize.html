<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canvas Example</title>
    <style>
        html,
        body {
            margin: 0;
            font-family: Verdana, Geneva, Tahoma, sans-serif;
            font-size:large;
            background-color: rgb(4, 24, 43);
            color: rgb(214, 225, 255);
            /* Remove default margin */
        }

        .pane {
            /* This is the class for the panes */
            background-color: rgb(71, 71, 71);
            margin: 11px;
            border: 1px solid #222;
            image-rendering: pixelated;
            border-radius: 3px;
            /* For pixelated rendering */

        }



        /*  flex styles  -------------------------------------------------------------------------------- */
        .flex-row {
            /* apply this to containers that contains elements that should be in a row */
            display: flex;
            flex-direction: row;
        }

        .flex-col {
            /* apply this to containers that contains elements that should be in a column */
            display: flex;
            flex-direction: column;
        }

        .flex {
            /* apply this to containers that should grow to fill the available space */
            flex-grow: 1;
        }

        .fix {
            /* apply this to containers that should not grow */
            flex-shrink: 0;
            flex-grow: 0;
        }

        /*    -------------------------------------------------------------------------------- */

        .main {
            height: 100vh;
        }

        .menuarea {
            margin-left: 0;
            width: 500px;
        }

        .container {
            width:10px;
            height: 100%;
        }

        .title {
            display: flex; 
            align-items: center; 
            justify-content: center;
            overflow: hidden;
            height: 40px;
            margin-bottom: 0px;            
        }

        .canvas {
            height: 100px;
            /* this  basically sets the minimum height  if you leave it out, the canvas will be the default height */
            object-fit: contain;
            /* this will make the canvas fit the container */
        }
    </style>
</head>

<body>
    <div class="main flex-row">
        <div class="container flex-col flex">
            <div id="button-bar" class="pane title">
            <h2>Canvas and CSS Example</h2>
            </div>
            <canvas id="myCanvas" class="pane canvas flex"></canvas>
        </div>
        <div class="pane menuarea fix"> </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.7.7/dat.gui.min.js"></script>
    <script type="module">
        import { Pane } from 'https://cdn.jsdelivr.net/npm/tweakpane@4.0.3/dist/tweakpane.min.js';
        const canvas = document.getElementById('myCanvas');
        const ctx = canvas.getContext('2d');

        let Q = {
            page_width: 300,
            page_height: 200,
            canvasResolution: 10,
            canvasColor: "#FFAABB",

        };

        const resize = () => {
            // Update the CSS variable for aspect ratio
            document.documentElement.style.setProperty('--aspect-ratio', Q.page_width / Q.page_height);

            // Set the canvas's internal drawing dimensions
            canvas.width = Q.page_width * Q.canvasResolution;
            canvas.height = Q.page_height * Q.canvasResolution;
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            // Clear and redraw the canvas
            ctx.fillStyle = "blue"
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            ctx.fillStyle = 'red';
            ctx.beginPath();
            ctx.moveTo(canvas.width / 2, 0);
            ctx.lineTo(canvas.width, canvas.height / 2);
            ctx.lineTo(canvas.width / 2, canvas.height);
            ctx.lineTo(0, canvas.height / 2);
            ctx.closePath();
            ctx.fill();
            // draw a rectangle without fill around the size of the canvas
            ctx.strokeStyle = 'black';
            // line width is 1 pixel
            ctx.lineWidth = 1;
            ctx.strokeRect(0, 0, canvas.width, canvas.height);



        };

        resize();

        // Add GUI controls
        //https://tweakpane.github.io/docs/quick-tour/
        const Menu = new Pane({ title: "Settings" , container: document.querySelector('.menuarea')});

        let guiItems = // array with name, min, (optional)max,(optional) step (optional)
            [
                ['page_width', 100, 600, 10],
                ['page_height', 100, 400, 10],
                ['canvasResolution', 0.01, 10],
                ['canvasColor'],
            ];


        for (const item of guiItems) {
            let [name, min, max, step] = item;
            let options = { min, max, step }
            item.forEach(v => { if (v === undefined) options[i] = null });
            Menu.addBinding(Q, name, options).on('change', resize);
        }

        let btn=Menu.addButton({title: 'Reset'})
            btn.on('click',_ => {
                Object.assign(Q, { page_width: 300, page_height: 200, canvasResolution: 10, canvasColor: "#FFAABB" });                        
            Menu.refresh();
            }
        );

        let ME = Menu.element, MS = ME.style;
       
        MS.height = '100%';
        MS.width = '100%';
        MS.borderRadius = '2px';
        // change the pane font style, color and size
        MS.fontFamily = 'Arial';
        MS.fontSize = '20px';
        MS.setProperty('--tp-blade-value-width', '200px');




        /*
        const PARAMS = {          percentage: 50,          theme: 'dark',        };
        pane.addBinding(          PARAMS, 'percentage',          {min: 0, max: 100, step: 10}        );
        pane.addBinding(          PARAMS, 'theme',          {options: {Dark: 'dark', Light: 'light'}}        );        
        const f = pane.addFolder({          title: 'Title',          expanded: true,        });
        const pane = new Pane({          title: 'Parameters',          expanded: true,        });
        pane.addBinding(sketch, 'signal', {          readonly: true,          view: 'graph',          interval: 200,
          min: -1,          max: +1,        });
        
        
               
        
        
        
        */
    </script>
</body>

</html>